<!DOCTYPE html>

<html>
    <head>
        <title>WebGL Model Viewer</title>
        
        <script type="text/javascript" src="./glMatrix-0.9.5.min.js"></script>
        
        <script type="text/javascript" src="./modelRenderer.js"></script>
        
        <script id="vert_shader" type="x-shader/x-vertex">
            attribute vec3 aVertexPosition;
        
            uniform mat4 uMVMatrix;
            uniform mat4 uPMatrix;
        
            void main() {
                gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);
            }
        </script>
        
        <script id="frag_shader" type="x-shader/x-fragment">
            void main() {
                gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);
            }
        </script>
        
        <script type="text/javascript">
            var sceneObjects;
            
            function initSceneObjects() {
                sceneObjects = [];
                
                var modelViewMatrix = mat4.create();
                mat4.identity(modelViewMatrix);
                mat4.translate(modelViewMatrix, [-1.5, 0.0, -7.0]);
                
                var vertices = [
                    0.0, 1.0, 0.0,
                    -1.0, -1.0, 0.0,
                    1.0, -1.0, 0.0
                ];
                var triangleVertexPositionBuffer = createBufferFromVertices(vertices, gl.TRIANGLES, 3, 3);
                var triangleSceneObject = {buffer: triangleVertexPositionBuffer, modelViewMatrix: modelViewMatrix};
                
                modelViewMatrix = mat4.create();
                mat4.identity(modelViewMatrix);
                mat4.translate(modelViewMatrix, [1.5, 0.0, -7.0]);
                
                vertices = [
                    1.0, 1.0, 0.0,
                    -1.0, 1.0, 0.0, 
                    1.0, -1.0, 0.0,
                    -1.0, -1.0, 0.0
                ];
                var squareVertexPositionBuffer = createBufferFromVertices(vertices, gl.TRIANGLE_STRIP, 3, 4);
                var squareSceneObject = {buffer: squareVertexPositionBuffer, modelViewMatrix: modelViewMatrix};
                sceneObjects.push(triangleSceneObject);
                sceneObjects.push(squareSceneObject);
            }
            
            function setMatrixUniforms() {
                gl.uniformMatrix4fv(shaderProgram.pMatrixUniform, false, pMatrix);
                gl.uniformMatrix4fv(shaderProgram.mvMatrixUniform, false, mvMatrix);
            }
        
            function webGLStart() {
                var canvas = document.getElementById("model_viewer_canvas");
                
                initModelRenderer(canvas);
                if(gl) {
                    initShaders();
                    initSceneObjects();
                    initMatrices();
                    initScene();
                
                    gl.clearColor(0.0, 0.0, 0.0, 1.0);
                    gl.enable(gl.DEPTH_TEST);
                
                    drawScene();
                }
            }
        </script>
    </head>
    <body onload="webGLStart();">
        <div id="content">
            <canvas id="model_viewer_canvas" width="500px" height="500px" />
            
            <div>
                
            </div>
        </div>
    </body>
</html>